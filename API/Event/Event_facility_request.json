{
  "api": {
    "name": "Event Reservations Management API",
    "version": "2.0.0",
    "description": "RESTful API for managing event reservations with Bearer token authentication",
    "base_url": "/api",
    "authentication": {
      "type": "Bearer Token",
      "header": "Authorization",
      "format": "Bearer {token}",
      "valid_tokens": [
        "Core_2_dept@4562526090892302633450908923026336"
      ]
    },
    "content_type": "application/json",
    "cors": {
      "allowed_origins": "*",
      "allowed_methods": ["GET", "POST", "PUT", "PATCH", "DELETE", "OPTIONS"],
      "allowed_headers": ["Content-Type", "Authorization", "X-API-Key", "X-Requested-With"]
    }
  },
  
  "database": {
    "name": "rest_m11_event",
    "main_table": "event_reservations",
    "connection_file": "../../main_connection.php"
  },
  
  "endpoints": {
    "GET": [
      {
        "path": "/api/reservations",
        "description": "Get all reservations with filtering and pagination",
        "parameters": {
          "query": {
            "page": {
              "type": "integer",
              "required": false,
              "default": 1,
              "description": "Page number for pagination"
            },
            "limit": {
              "type": "integer",
              "required": false,
              "default": 20,
              "min": 1,
              "max": 100,
              "description": "Number of items per page"
            },
            "status": {
              "type": "string",
              "required": false,
              "description": "Filter by reservation status",
              "enum": ["Pending", "Confirmed", "Approved", "Requested", "Reserved", "Denied", "Cancelled", "Under Review"]
            },
            "date_from": {
              "type": "string",
              "format": "date",
              "required": false,
              "description": "Filter events from this date (YYYY-MM-DD)"
            },
            "date_to": {
              "type": "string",
              "format": "date",
              "required": false,
              "description": "Filter events until this date (YYYY-MM-DD)"
            },
            "search": {
              "type": "string",
              "required": false,
              "description": "Search in customer_name, event_name, customer_email, or reservation_id"
            }
          }
        },
        "response": {
          "success": "boolean",
          "data": "array<Reservation>",
          "pagination": {
            "current_page": "integer",
            "total_pages": "integer",
            "total_items": "integer",
            "items_per_page": "integer"
          },
          "filters": {
            "status": "string|null",
            "date_from": "string|null",
            "date_to": "string|null",
            "search": "string|null"
          }
        }
      },
      {
        "path": "/api/reservations/requested",
        "description": "Get reservations with 'Requested' status",
        "parameters": {
          "query": {
            "page": {
              "type": "integer",
              "required": false,
              "default": 1
            },
            "limit": {
              "type": "integer",
              "required": false,
              "default": 20,
              "max": 100
            }
          }
        },
        "response": {
          "success": "boolean",
          "data": "array<Reservation>",
          "pagination": {
            "current_page": "integer",
            "total_pages": "integer",
            "total_items": "integer",
            "items_per_page": "integer"
          },
          "metadata": {
            "status": "Requested",
            "description": "Reservations requiring facility setup approval"
          }
        }
      },
      {
        "path": "/api/reservations/approved",
        "description": "Get approved reservations",
        "parameters": {
          "query": {
            "page": {
              "type": "integer",
              "required": false,
              "default": 1
            },
            "limit": {
              "type": "integer",
              "required": false,
              "default": 20,
              "max": 100
            }
          }
        },
        "response": {
          "success": "boolean",
          "data": "array<Reservation>",
          "pagination": "PaginationObject",
          "metadata": {
            "status": "Approved",
            "description": "Reservations with Approved status"
          }
        }
      },
      {
        "path": "/api/reservations/confirmed",
        "description": "Get confirmed reservations",
        "parameters": {
          "query": {
            "page": {
              "type": "integer",
              "required": false,
              "default": 1
            },
            "limit": {
              "type": "integer",
              "required": false,
              "default": 20,
              "max": 100
            }
          }
        },
        "response": {
          "success": "boolean",
          "data": "array<Reservation>",
          "pagination": "PaginationObject",
          "metadata": {
            "status": "Confirmed",
            "description": "Reservations with Confirmed status"
          }
        }
      },
      {
        "path": "/api/reservations/{id}",
        "description": "Get single reservation by ID",
        "parameters": {
          "path": {
            "id": {
              "type": "integer",
              "required": true,
              "description": "Reservation ID"
            }
          }
        },
        "response": {
          "success": "boolean",
          "data": "Reservation"
        }
      },
      {
        "path": "/api/columns",
        "description": "Fetch database table columns/schema",
        "parameters": {
          "query": {
            "table": {
              "type": "string",
              "required": false,
              "default": "event_reservations",
              "description": "Table name to get columns from"
            }
          }
        },
        "response": {
          "success": "boolean",
          "table": "string",
          "comment": "string",
          "total_columns": "integer",
          "columns": "array<ColumnDefinition>",
          "timestamp": "string"
        }
      },
      {
        "path": "/api/updates/latest",
        "description": "Fetch the latest updated transactions",
        "parameters": {
          "query": {
            "limit": {
              "type": "integer",
              "required": false,
              "default": 20,
              "max": 50
            },
            "hours": {
              "type": "integer",
              "required": false,
              "default": 24,
              "description": "Number of hours to look back"
            }
          }
        },
        "response": {
          "success": "boolean",
          "data": "array<Reservation>",
          "metadata": {
            "timeframe_hours": "integer",
            "total_fetched": "integer",
            "as_of": "string",
            "description": "Latest reservations updated by other departments"
          }
        }
      },
      {
        "path": "/api/updates/since/{timestamp}",
        "description": "Fetch updates since specific timestamp",
        "parameters": {
          "path": {
            "timestamp": {
              "type": "string",
              "required": true,
              "description": "Timestamp in YYYY-MM-DD HH:MM:SS format"
            }
          },
          "query": {
            "limit": {
              "type": "integer",
              "required": false,
              "default": 50,
              "max": 100
            }
          }
        },
        "response": {
          "success": "boolean",
          "data": "array<Reservation>",
          "metadata": {
            "since_timestamp": "string",
            "total_fetched": "integer",
            "fetched_at": "string",
            "description": "Reservations updated since specified timestamp"
          }
        }
      }
    ],
    
    "POST": [
      {
        "path": "/api/reservations",
        "description": "Create a new reservation",
        "request_body": {
          "required": [
            "customer_name",
            "customer_email", 
            "event_name",
            "event_date",
            "event_time"
          ],
          "properties": {
            "customer_name": {
              "type": "string",
              "description": "Full name of the customer"
            },
            "customer_email": {
              "type": "string",
              "format": "email",
              "description": "Customer email address"
            },
            "customer_phone": {
              "type": "string",
              "required": false
            },
            "event_name": {
              "type": "string",
              "description": "Name of the event"
            },
            "event_type": {
              "type": "string",
              "required": false
            },
            "event_date": {
              "type": "string",
              "format": "date",
              "description": "Event date (YYYY-MM-DD)"
            },
            "event_time": {
              "type": "string",
              "description": "Event time (HH:MM:SS)"
            },
            "venue": {
              "type": "string",
              "required": false
            },
            "num_guests": {
              "type": "integer",
              "required": false
            },
            "reservation_status": {
              "type": "string",
              "required": false,
              "default": "Pending",
              "enum": ["Pending", "Confirmed", "Approved", "Requested", "Reserved", "Denied", "Cancelled", "Under Review"]
            },
            "payment_status": {
              "type": "string",
              "required": false,
              "default": "Pending"
            }
          }
        },
        "response": {
          "success": "boolean",
          "message": "string",
          "data": "Reservation",
          "metadata": {
            "id": "integer",
            "created_at": "string"
          }
        }
      },
      {
        "path": "/api/reservations/batch",
        "description": "Create multiple reservations at once",
        "request_body": {
          "required": ["reservations"],
          "properties": {
            "reservations": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ReservationInput"
              },
              "description": "Array of reservation objects"
            }
          }
        },
        "response": {
          "success": "boolean",
          "message": "string",
          "results": {
            "successful": "array<BatchResult>",
            "failed": "array<BatchResult>",
            "total": "integer"
          },
          "summary": {
            "created": "integer",
            "failed": "integer",
            "total": "integer"
          }
        }
      }
    ],
    
    "PUT": [
      {
        "path": "/api/reservations/{id}",
        "description": "Update entire reservation",
        "parameters": {
          "path": {
            "id": {
              "type": "integer",
              "required": true
            }
          }
        },
        "request_body": {
          "type": "object",
          "description": "Complete reservation object with updated values"
        },
        "response": {
          "success": "boolean",
          "message": "string",
          "data": "Reservation"
        }
      },
      {
        "path": "/api/reservations/{id}/status",
        "description": "Update reservation status only",
        "parameters": {
          "path": {
            "id": {
              "type": "integer",
              "required": true
            }
          }
        },
        "request_body": {
          "required": ["status"],
          "properties": {
            "status": {
              "type": "string",
              "enum": ["Pending", "Confirmed", "Approved", "Requested", "Reserved", "Denied", "Cancelled", "Under Review"]
            },
            "notes": {
              "type": "string",
              "required": false,
              "description": "Optional notes about the status change"
            }
          }
        },
        "response": {
          "success": "boolean",
          "message": "string",
          "data": {
            "id": "integer",
            "new_status": "string",
            "updated_at": "string"
          }
        }
      }
    ],
    
    "PATCH": [
      {
        "path": "/api/reservations/{id}",
        "description": "Partially update reservation",
        "parameters": {
          "path": {
            "id": {
              "type": "integer",
              "required": true
            }
          }
        },
        "request_body": {
          "type": "object",
          "description": "Object with only the fields to update"
        },
        "response": {
          "success": "boolean",
          "message": "string",
          "data": {
            "id": "integer",
            "updated_fields": "array<string>",
            "updated_at": "string"
          }
        }
      }
    ]
  },
  
  "definitions": {
    "Reservation": {
      "type": "object",
      "properties": {
        "reservation_id": {
          "type": "integer",
          "description": "Unique reservation identifier"
        },
        "customer_name": {
          "type": "string"
        },
        "customer_email": {
          "type": "string",
          "format": "email"
        },
        "customer_phone": {
          "type": "string",
          "nullable": true
        },
        "event_name": {
          "type": "string"
        },
        "event_type": {
          "type": "string",
          "nullable": true
        },
        "event_date": {
          "type": "string",
          "format": "date"
        },
        "event_date_formatted": {
          "type": "string",
          "format": "date"
        },
        "event_time": {
          "type": "string"
        },
        "event_time_formatted": {
          "type": "string",
          "pattern": "^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$"
        },
        "venue": {
          "type": "string",
          "nullable": true
        },
        "num_guests": {
          "type": "integer",
          "nullable": true
        },
        "total_amount": {
          "type": "number",
          "nullable": true
        },
        "amount_paid": {
          "type": "number",
          "nullable": true
        },
        "payment_status": {
          "type": "string"
        },
        "reservation_status": {
          "type": "string",
          "enum": ["Pending", "Confirmed", "Approved", "Requested", "Reserved", "Denied", "Cancelled", "Under Review"]
        },
        "special_requests": {
          "type": "string",
          "nullable": true
        },
        "facility_notes": {
          "type": "string",
          "nullable": true
        },
        "event_package": {
          "type": "string",
          "nullable": true
        },
        "MOP": {
          "type": "string",
          "nullable": true,
          "description": "Mode of Payment"
        },
        "notes": {
          "type": "string",
          "nullable": true
        },
        "image_url": {
          "type": "string",
          "nullable": true
        },
        "image_full_url": {
          "type": "string",
          "nullable": true,
          "description": "Complete URL to the image"
        },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "created_at_formatted": {
          "type": "string",
          "format": "date-time"
        },
        "updated_at": {
          "type": "string",
          "format": "date-time",
          "nullable": true
        },
        "updated_at_formatted": {
          "type": "string",
          "format": "date-time",
          "nullable": true
        },
        "days_until_event": {
          "type": "integer",
          "description": "Number of days until the event"
        },
        "is_upcoming": {
          "type": "boolean",
          "description": "Whether the event is in the future"
        }
      }
    },
    
    "ReservationInput": {
      "type": "object",
      "properties": {
        "customer_name": {
          "type": "string",
          "required": true
        },
        "customer_email": {
          "type": "string",
          "format": "email",
          "required": true
        },
        "event_name": {
          "type": "string",
          "required": true
        },
        "event_date": {
          "type": "string",
          "format": "date",
          "required": true
        },
        "event_time": {
          "type": "string",
          "required": true
        },
        "reservation_status": {
          "type": "string",
          "default": "Pending"
        }
      }
    },
    
    "ColumnDefinition": {
      "type": "object",
      "properties": {
        "field": {
          "type": "string",
          "description": "Column name"
        },
        "type": {
          "type": "string",
          "description": "Data type (e.g., varchar(255), int, datetime)"
        },
        "null": {
          "type": "string",
          "enum": ["YES", "NO"],
          "description": "Whether NULL values are allowed"
        },
        "key": {
          "type": "string",
          "description": "Index information (PRI, UNI, MUL)"
        },
        "default": {
          "type": "string",
          "nullable": true,
          "description": "Default value"
        },
        "extra": {
          "type": "string",
          "description": "Additional information (auto_increment, etc.)"
        }
      }
    },
    
    "PaginationObject": {
      "type": "object",
      "properties": {
        "current_page": {
          "type": "integer"
        },
        "total_pages": {
          "type": "integer"
        },
        "total_items": {
          "type": "integer"
        },
        "items_per_page": {
          "type": "integer"
        }
      }
    },
    
    "BatchResult": {
      "type": "object",
      "properties": {
        "index": {
          "type": "integer",
          "description": "Index in the input array"
        },
        "id": {
          "type": "integer",
          "description": "Created reservation ID (for successful)"
        },
        "status": {
          "type": "string",
          "enum": ["created", "failed"]
        },
        "error": {
          "type": "string",
          "description": "Error message (for failed)"
        }
      }
    }
  },
  
  "error_responses": {
    "400": {
      "description": "Bad Request - Invalid parameters or data",
      "schema": {
        "success": false,
        "message": "string",
        "details": "object"
      }
    },
    "401": {
      "description": "Unauthorized - Invalid or missing Bearer token",
      "schema": {
        "success": false,
        "message": "string",
        "hint": "Use: Authorization: Bearer YOUR_TOKEN"
      }
    },
    "404": {
      "description": "Not Found - Endpoint or resource not found",
      "schema": {
        "success": false,
        "message": "string",
        "available_endpoints": "object"
      }
    },
    "405": {
      "description": "Method Not Allowed",
      "schema": {
        "success": false,
        "message": "string",
        "allowed_methods": "array<string>"
      }
    },
    "500": {
      "description": "Internal Server Error",
      "schema": {
        "success": false,
        "message": "string",
        "error": "string"
      }
    }
  },
  
  "examples": {
    "create_reservation": {
      "request": {
        "method": "POST",
        "url": "/api/reservations",
        "headers": {
          "Authorization": "Bearer Core_2_dept@4562526090892302633450908923026336",
          "Content-Type": "application/json"
        },
        "body": {
          "customer_name": "John Doe",
          "customer_email": "john@example.com",
          "customer_phone": "555-1234",
          "event_name": "Birthday Party",
          "event_type": "Celebration",
          "event_date": "2024-12-25",
          "event_time": "14:00:00",
          "venue": "Grand Ballroom",
          "num_guests": 50,
          "reservation_status": "Pending",
          "special_requests": "Vegetarian options required"
        }
      },
      "response": {
        "status": 200,
        "body": {
          "success": true,
          "message": "Reservation created successfully",
          "data": {
            "reservation_id": 123,
            "customer_name": "John Doe",
            "customer_email": "john@example.com",
            "event_name": "Birthday Party",
            "event_date": "2024-12-25",
            "event_date_formatted": "2024-12-25",
            "event_time": "14:00:00",
            "event_time_formatted": "14:00",
            "reservation_status": "Pending",
            "created_at": "2024-01-10 10:30:00",
            "created_at_formatted": "2024-01-10 10:30:00",
            "days_until_event": 350,
            "is_upcoming": true
          },
          "metadata": {
            "id": 123,
            "created_at": "2024-01-10 10:30:00"
          }
        }
      }
    },
    
    "get_latest_updates": {
      "request": {
        "method": "GET",
        "url": "/api/updates/latest?hours=48&limit=10",
        "headers": {
          "Authorization": "Bearer Core_2_dept@4562526090892302633450908923026336"
        }
      },
      "response": {
        "status": 200,
        "body": {
          "success": true,
          "data": [
            {
              "reservation_id": 125,
              "customer_name": "Jane Smith",
              "event_name": "Conference",
              "reservation_status": "Approved",
              "updated_at": "2024-01-10 09:15:00",
              "updated_by_department": "Facilities"
            }
          ],
          "metadata": {
            "timeframe_hours": 48,
            "total_fetched": 1,
            "as_of": "2024-01-10 10:30:00",
            "description": "Latest reservations updated by other departments"
          }
        }
      }
    },
    
    "get_database_columns": {
      "request": {
        "method": "GET",
        "url": "/api/columns",
        "headers": {
          "Authorization": "Bearer Core_2_dept@4562526090892302633450908923026336"
        }
      },
      "response": {
        "status": 200,
        "body": {
          "success": true,
          "table": "event_reservations",
          "comment": "Table for storing event reservation information",
          "total_columns": 25,
          "columns": [
            {
              "field": "reservation_id",
              "type": "int(11)",
              "null": "NO",
              "key": "PRI",
              "default": null,
              "extra": "auto_increment"
            },
            {
              "field": "customer_name",
              "type": "varchar(255)",
              "null": "NO",
              "key": "",
              "default": null,
              "extra": ""
            }
          ],
          "timestamp": "2024-01-10 10:30:00"
        }
      }
    }
  }
}